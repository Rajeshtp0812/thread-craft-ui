"use strict";(self.webpackChunkthread_craft=self.webpackChunkthread_craft||[]).push([[481],{6481:(k,h,i)=>{i.r(h),i.d(h,{ClientsModule:()=>W});var C=i(6814),g=i(9854),c=i(5861),p=i(9140),e=i(4946),v=i(9862),M=i(8645),m=i(708);const d=i(553).N.clientServiceURL,x={headers:new v.WM({"Content-Type":"application/json"})};let T=(()=>{class n{constructor(t){this.http=t,this.refetchData=new M.x}getClient(t){return(0,m.n)(this.http.get(`${d}${t}`,{}))}getClients(){return(0,m.n)(this.http.get(d,{}))}createClient(t){return(0,m.n)(this.http.post(d,t,x))}updateClient(t,l){return(0,m.n)(this.http.put(`${d}${t}`,l,x))}deleteClient(t){return(0,m.n)(this.http.delete(`${d}${t}`))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(v.eN))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var u=i(5219),D=i(7949),b=i(707),F=i(7213),s=i(4685),y=i(3714),S=i(3259),_=i(9897);const A=["cm"],z=function(){return{header:"true"}};function N(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",8)(1,"span",9),e._UZ(2,"i",10),e.TgZ(3,"input",11),e.NdJ("input",function(a){e.CHM(t);const r=e.oxw(),f=e.MAs(1);return e.KtG(r.onGlobalFilter(f,a))}),e.qZA()(),e.TgZ(4,"div",12),e.NdJ("click",function(a){e.CHM(t);const r=e.oxw();return e.KtG(r.onContextMenu(a,"tableMenu"))}),e._UZ(5,"i",13),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(3),e.Q6J("disabled",0===(null==t.data?null:t.data.length)),e.xp6(1),e.Q6J("pContextMenuRow",e.DdM(2,z))}}function J(n,o){if(1&n&&(e.TgZ(0,"th",16),e._uU(1),e._UZ(2,"p-sortIcon",17),e.qZA()),2&n){const t=o.$implicit;e.s9C("pSortableColumn",t.field),e.xp6(1),e.hij(" ",t.header,""),e.xp6(1),e.s9C("field",t.field)}}function w(n,o){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,J,3,3,"th",14),e._UZ(2,"th",15),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.cols)}}function G(n,o){if(1&n&&(e.TgZ(0,"td",21),e._uU(1),e.qZA()),2&n){const t=o.$implicit,l=e.oxw().$implicit;e.s9C("pTooltip",l[t.field]),e.xp6(1),e.hij(" ",l[t.field]," ")}}function R(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr"),e.YNc(1,G,2,2,"td",18),e.TgZ(2,"td",19)(3,"div")(4,"i",20),e.NdJ("click",function(a){const f=e.CHM(t).$implicit,X=e.oxw();return e.KtG(X.onContextMenu(a,"rowMenu",f))}),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.cols)}}function U(n,o){1&n&&(e.TgZ(0,"td",23),e._uU(1," No record found. "),e.qZA())}function I(n,o){1&n&&(e.TgZ(0,"td",23),e._uU(1," No data to display. "),e.qZA())}function Q(n,o){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,U,2,0,"td",22),e.YNc(2,I,2,0,"td",22),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",!t.isDataLoading&&(null==t.data?null:t.data.length)),e.xp6(1),e.Q6J("ngIf",!(t.isDataLoading||null!=t.data&&t.data.length))}}const O=function(){return["code"]};let Y=(()=>{class n{constructor(t,l){this.clientService=t,this.messageService=l,this.isDataLoading=!1,this.cols=[{field:"companyName",header:"Company"},{field:"email",header:"Email"},{field:"contact",header:"Contact"},{field:"state",header:"State"},{field:"city",header:"City"},{field:"address",header:"Address"},{field:"pinCode",header:"Pin Code"},{field:"gst",header:"GST"}],this.data=[],this.openCompaniesForm=new e.vpe,this.filterFields=[]}ngOnInit(){var t=this;return(0,c.Z)(function*(){t.fetchData(),t.clientService.refetchData.subscribe(l=>t.fetchData())})()}fetchData(){var t=this;return(0,c.Z)(function*(){t.isDataLoading=!0;try{let l=yield t.clientService.getClients();t.data=l.data}catch{t.messageService.add({severity:"error",summary:"Unexpected system error",detail:""})}finally{t.isDataLoading=!1}})()}onContextMenu(t,l,a=null){t.preventDefault(),"tableMenu"===l?this.contextMenus=[{label:"Add",data:a,command:()=>this.openCompaniesForm.emit({modalType:p.fG.ADD,data:null})}]:"rowMenu"===l&&(this.contextMenus=[{label:"Edit",data:a,command:r=>this.openCompaniesForm.emit({modalType:p.fG.EDIT,data:r})},{label:"Delete",data:a,command:r=>this.deleteClient(r)}]),this.contextMenu.show(t)}deleteClient(t){var l=this;return(0,c.Z)(function*(){try{yield l.clientService.deleteClient(t.item.data.clientId),l.clientService.refetchData.next(!0)}catch{l.messageService.add({severity:"error",summary:"Unexpected system error",detail:""})}})()}onGlobalFilter(t,l){t.filterGlobal(l.target.value,"contains")}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T),e.Y36(u.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-clients-table"]],viewQuery:function(t,l){if(1&t&&e.Gf(A,5),2&t){let a;e.iGM(a=e.CRH())&&(l.contextMenu=a.first)}},outputs:{openCompaniesForm:"openCompaniesForm"},decls:8,vars:15,consts:[["responsiveLayout","scroll","dataKey","id","scrollDirection","horizontal","scrollHeight","250px",3,"value","columns","globalFilterFields","showCurrentPageReport","rowHover","resizableColumns","contextMenu","reorderableColumns","loading","scrollable","virtualScroll","virtualScrollItemSize"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["triggerEvent","click",3,"model"],["cm",""],[1,"flex","flex-column","md:flex-row","md:justify-content-between","md:align-items-center"],[1,"block","mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",1,"w-full","sm:w-auto",3,"disabled","input"],[3,"pContextMenuRow","click"],[1,"pi","pi-ellipsis-v","action-menu"],["pResizableColumn","","pReorderableColumn","",3,"pSortableColumn",4,"ngFor","ngForOf"],["alignFrozen","right","pFrozenColumn","",2,"max-width","5px"],["pResizableColumn","","pReorderableColumn","",3,"pSortableColumn"],[3,"field"],["pResizableColumn","","class","p-text-nowrap p-text-truncate","tooltipPosition","bottom",3,"pTooltip",4,"ngFor","ngForOf"],["alignFrozen","right","pFrozenColumn","",2,"width","5px"],[1,"pi","pi-ellipsis-h","action-menu",3,"click"],["pResizableColumn","","tooltipPosition","bottom",1,"p-text-nowrap","p-text-truncate",3,"pTooltip"],["colspan","cols?.length",4,"ngIf"],["colspan","cols?.length"]],template:function(t,l){if(1&t&&(e.TgZ(0,"p-table",0,1),e.YNc(2,N,6,3,"ng-template",2),e.YNc(3,w,3,1,"ng-template",3),e.YNc(4,R,5,1,"ng-template",4),e.YNc(5,Q,3,2,"ng-template",5),e.qZA(),e._UZ(6,"p-contextMenu",6,7)),2&t){const a=e.MAs(7);e.Q6J("value",l.data)("columns",l.cols)("globalFilterFields",l.filterFields)("showCurrentPageReport",!0)("rowHover",!0)("resizableColumns",!0)("contextMenu",a)("globalFilterFields",e.DdM(14,O))("reorderableColumns",!0)("loading",l.isDataLoading)("scrollable",!0)("virtualScroll",!0)("virtualScrollItemSize",40),e.xp6(6),e.Q6J("model",l.contextMenus)}},dependencies:[C.sg,C.O5,s.iA,u.jx,s.lQ,s.on,s.zi,s.Q7,s.Af,s.fz,y.o,S.u,_.xV]}),n})();function $(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.closeForm())}),e.qZA(),e.TgZ(1,"button",6),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.saveClient())}),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.s9C("label","edit"===t.selectedModal?"Save":"Create"),e.Q6J("disabled",!t.isFormValid)}}const j=function(){return{width:"650px"}},E=[{path:"",component:(()=>{class n{constructor(t,l){this.clientService=t,this.messageService=l,this.isClientFormOpen=!1,this.editClientDetail=null,this.isFormValid=!1,this.formData=null}openCompaniesForm(t){this.isClientFormOpen=!this.isClientFormOpen,this.editClientDetail=null,this.selectedModal=t.modalType,console.log(t),t?.modalType===p.fG.EDIT&&(this.editClientDetail=t.data.item.data)}closeForm(){this.isClientFormOpen=!1}setFormData(t){var l=this;return(0,c.Z)(function*(){l.isFormValid=t.status,l.formData=t.data})()}saveClient(){var t=this;return(0,c.Z)(function*(){if(t.isFormValid)try{t.selectedModal===p.fG.ADD?(yield t.clientService.createClient(t.formData),t.messageService.add({severity:"success",summary:"Company created successfully",detail:""})):t.selectedModal===p.fG.EDIT&&(yield t.clientService.updateClient(t.editClientDetail.clientId,t.formData),t.messageService.add({severity:"success",summary:"Company updated succesfully",detail:""})),t.closeForm(),t.clientService.refetchData.next(!0)}catch{t.messageService.add({severity:"error",summary:"Unexpected system error",detail:""})}})()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(T),e.Y36(u.ez))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-clients-main"]],decls:7,vars:12,consts:[[1,"col-12","card"],[3,"openCompaniesForm"],[1,"p-fluid",3,"visible","header","modal","resizable","closable","maximizable","visibleChange"],[3,"wrapperComponentName","updateFormData","clearForm","formData"],["pTemplate","footer"],["pButton","","pRipple","","type","button","label","Cancel",1,"p-button-raised","p-button-secondary",3,"click"],["pButton","","pRipple","","type","button",1,"p-button-raised",3,"label","disabled","click"]],template:function(t,l){1&t&&(e.TgZ(0,"div",0)(1,"h5"),e._uU(2,"Clients"),e.qZA(),e.TgZ(3,"app-clients-table",1),e.NdJ("openCompaniesForm",function(r){return l.openCompaniesForm(r)}),e.qZA()(),e.TgZ(4,"p-dialog",2),e.NdJ("visibleChange",function(r){return l.isClientFormOpen=r}),e.TgZ(5,"app-common-form",3),e.NdJ("formData",function(r){return l.setFormData(r)}),e.qZA(),e.YNc(6,$,2,2,"ng-template",4),e.qZA()),2&t&&(e.xp6(4),e.Akn(e.DdM(11,j)),e.s9C("header","edit"===l.selectedModal?"Edit Client Details":"Create New Client"),e.Q6J("visible",l.isClientFormOpen)("modal",!0)("resizable",!0)("closable",!1)("maximizable",!0),e.xp6(1),e.Q6J("wrapperComponentName","client")("updateFormData",l.editClientDetail)("clearForm",l.isClientFormOpen))},dependencies:[D.V,u.jx,b.Hq,F.V,Y]}),n})()}];let H=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[g.Bz.forChild(E),g.Bz]}),n})();var L=i(1122),V=i(2352),B=i(95),K=i(6218),P=i(2662);let W=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[C.ez,P._,B.u5,H,s.U$,y.j,b.hJ,L.$9,_.vI,F.S,V.kW,K.A]}),n})()}}]);